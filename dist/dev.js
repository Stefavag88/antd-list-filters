!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("antd/lib/card/style"),require("antd/lib/card"),require("antd/lib/popover/style"),require("antd/lib/popover"),require("antd/lib/tooltip/style"),require("antd/lib/tooltip"),require("antd/lib/icon/style"),require("antd/lib/icon"),require("antd/lib/drawer/style"),require("antd/lib/drawer"),require("antd/lib/button/style"),require("antd/lib/button"),require("antd/lib/checkbox/style"),require("antd/lib/checkbox"),require("react"),require("prop-types"),require("date-fns/format"),require("date-fns/parse"),require("date-fns/is_after"),require("date-fns/is_equal"),require("date-fns/is_within_range"),require("date-fns/is_before"),require("expr-eval"),require("antd/lib/input/style"),require("antd/lib/input"),require("antd/lib/select/style"),require("antd/lib/select"),require("antd/lib/input-number/style"),require("antd/lib/input-number"),require("antd/lib/date-picker/style"),require("antd/lib/date-picker"),require("date-fns/is_valid"),require("antd/lib/auto-complete/style"),require("antd/lib/auto-complete")):"function"==typeof define&&define.amd?define(["exports","antd/lib/card/style","antd/lib/card","antd/lib/popover/style","antd/lib/popover","antd/lib/tooltip/style","antd/lib/tooltip","antd/lib/icon/style","antd/lib/icon","antd/lib/drawer/style","antd/lib/drawer","antd/lib/button/style","antd/lib/button","antd/lib/checkbox/style","antd/lib/checkbox","react","prop-types","date-fns/format","date-fns/parse","date-fns/is_after","date-fns/is_equal","date-fns/is_within_range","date-fns/is_before","expr-eval","antd/lib/input/style","antd/lib/input","antd/lib/select/style","antd/lib/select","antd/lib/input-number/style","antd/lib/input-number","antd/lib/date-picker/style","antd/lib/date-picker","date-fns/is_valid","antd/lib/auto-complete/style","antd/lib/auto-complete"],t):t(((e=e||self).lib=e.lib||{},e.lib.browwser={}),null,e._Card,null,e._Popover,null,e._Tooltip,null,e._Icon,null,e._Drawer,null,e._Button,null,e._Checkbox,e.React,e.PropTypes,e.fnsFormatDate,e.fnsParseDate,e.fnsIsAfter,e.fnsIsEqual,e.fnsIsWithinRange,e.fnsIsBefore,e.exprEval,null,e._Input,null,e._Select,null,e._InputNumber,null,e._DatePicker,e.fnsIsValid,null,e._AutoComplete)}(this,function(e,t,i,r,a,n,l,s,o,u,c,d,f,p,m,h,y,v,F,b,S,g,E,w,C,k,B,q,N,R,D,O,x,P,I){"use strict";function M(e,t,r,n,i,a,l){try{var s=e[a](l),o=s.value}catch(e){return void r(e)}s.done?t(o):Promise.resolve(o).then(n,i)}function _(s){return function(){var e=this,l=arguments;return new Promise(function(t,r){var n=s.apply(e,l);function i(e){M(n,t,r,i,a,"next",e)}function a(e){M(n,t,r,i,a,"throw",e)}i(void 0)})}}function A(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}i=i&&i.hasOwnProperty("default")?i.default:i,a=a&&a.hasOwnProperty("default")?a.default:a,l=l&&l.hasOwnProperty("default")?l.default:l,o=o&&o.hasOwnProperty("default")?o.default:o,c=c&&c.hasOwnProperty("default")?c.default:c,f=f&&f.hasOwnProperty("default")?f.default:f,m=m&&m.hasOwnProperty("default")?m.default:m,h=h&&h.hasOwnProperty("default")?h.default:h,y=y&&y.hasOwnProperty("default")?y.default:y,v=v&&v.hasOwnProperty("default")?v.default:v,F=F&&F.hasOwnProperty("default")?F.default:F,b=b&&b.hasOwnProperty("default")?b.default:b,S=S&&S.hasOwnProperty("default")?S.default:S,g=g&&g.hasOwnProperty("default")?g.default:g,E=E&&E.hasOwnProperty("default")?E.default:E,k=k&&k.hasOwnProperty("default")?k.default:k,q=q&&q.hasOwnProperty("default")?q.default:q,R=R&&R.hasOwnProperty("default")?R.default:R,O=O&&O.hasOwnProperty("default")?O.default:O,x=x&&x.hasOwnProperty("default")?x.default:x,I=I&&I.hasOwnProperty("default")?I.default:I;var V=function(e){var t=e.uiName;if(!t)throw new Error("ERROR: No uiName defined for field "+e);return t},T=function(e){var t=j(e);if("date"!==t)throw new Error("ERROR: Trying to get date format for non-date field, "+e);var r=e.format;if("date"===t&&!r)throw new Error("ERROR: No dateformat defined for field "+e);return r},j=function(e){return e.type},L=function(e,t){var r=e.dataSource;if(r||console.warn("WARNING: No dataSource property given to the field the field "+e.uiName+"."),!r&&t)throw new Error("ERROR: property dataSource is required for field "+e.uiName);if(r&&0===r.length&&t)throw new Error("WARNING: property dataSource for field "+e.uiName+" is passed but is an empty array. ");return r},U=function(e,t){var r=Object.keys(e).find(function(e){return e===t});if(!r)throw new Error("ERROR: No field defined with the name "+t+".");return r},W=function(e,t){var r,n=[].concat(e.map(function(e){return e[t]})),i=new Set(n);return(r=i).has(null)&&r.delete(null),r.has(void 0)&&r.delete(void 0),r.has("")&&r.delete(""),0<(i=r).size?Array.from(i):[]},Y={"<":"checkIsBefore",">":"checkIsAfter",in:"checkIsBetween","==":"checkIsSame"},z=new w.Parser,G=function(e,t){return v(F(e),t)};z.functions.checkIsBefore=function(e,t,r){return E(G(e,r),G(t,r))},z.functions.checkIsAfter=function(e,t,r){return b(G(e,r),G(t,r))},z.functions.checkIsBetween=function(e,t,r,n){return g(G(e,n),G(t,n),G(r,n))},z.functions.checkIsSame=function(e,t,r){return S(G(e,r),G(t,r))},z.functions.isLike=function(e,t){return e.includes(t)};var H=function(e,t,r){var n=t.split(","),i=n[0].split(" "),a=i[0],l=i[1],s=n[1];return Y[a]+"(d."+e+", '"+l+"', '"+s+"', '"+r+"')"},Q=function(e,t,r){var n=t.split(" "),i=n[0],a=n[1];return Y[i]+"(d."+e+", '"+a+"', '"+r+"')"},J=k.Search,K=function(t){function e(e){var n;return(n=t.call(this,e)||this).innerOnSearch=function(e){n.props.onSearch(e)},n.componentDidUpdate=function(e,t,r){n.props.clearText&&!e.clearText&&(n.inputRef.current.input.input.value=null)},n.inputRef=h.createRef(),n}return A(e,t),e.prototype.render=function(){return h.createElement(J,{ref:this.inputRef,onSearch:this.innerOnSearch,placeholder:"Search..."})},e}(h.Component),X=q.Option,Z=function(t){function e(e){var n;return(n=t.call(this,e)||this).componentDidUpdate=function(e,t){n.props.onChange(n.state)},n.handleChange=function(r){"string"==typeof r?n.setState(function(e,t){return{operator:r}}):n.setState(function(e,t){return{number:r}})},n.state={operator:"==",number:null},n}return A(e,t),e.prototype.render=function(){var e=this.props,t=e.name,r=e.min,n=e.max;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,t),h.createElement("div",{className:"filter-content"},h.createElement(q,{className:"operator-value",defaultValue:"==",onChange:this.handleChange},h.createElement(X,{value:">="}," >= "),h.createElement(X,{value:"<="}," <= "),h.createElement(X,{value:">"}," > "),h.createElement(X,{value:"<"}," < "," "),h.createElement(X,{value:"=="}," = "),h.createElement(X,{value:"!="}," != ")),h.createElement(R,{className:"filter-value",onChange:this.handleChange,key:t,placeholder:t,min:r,max:n})))},e}(h.Component);Z.propTypes={onChange:y.func.isRequired,name:y.string.isRequired,min:y.number,max:y.number};var $=function(t){function e(e){var n;return(n=t.call(this,e)||this).componentDidUpdate=function(e,t){n.props.onChange(n.state)},n.handleChange=function(r){n.setState(function(e,t){return{value:r}})},n.state={value:null},n}return A(e,t),e.prototype.render=function(){var e=this.props.name;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,e),h.createElement("div",{className:"filter-content"},h.createElement(q,{style:{minWidth:200,width:"100%"},allowClear:!0,key:e,onChange:this.handleChange,placeholder:e},h.createElement(q.Option,{key:!0},"YES"),h.createElement(q.Option,{key:!1},"NO"),h.createElement(q.Option,{key:" - "}," - "))))},e}(h.Component);$.propTypes={onChange:y.func.isRequired,name:y.string.isRequired};var ee=q.Option,te=function(e,t){return v(F(e),t)},re=function(e){return x(F(e))},ne=function(t){function e(e){var i;return(i=t.call(this,e)||this).componentDidUpdate=function(e,t){i.props.onChange(i.state)},i.handleChange=function(r){if("string"==typeof r)i.setState(function(e,t){return{operator:r,date:null}},function(){i.dateRef.current.picker.clearSelection(new Event("clearEvent"))});else{var n=[];if(Array.isArray(r))r.forEach(function(e){re(e)&&n.push(te(e,i.props.format))});else{if(!re(r))return;n.push(te(r,i.props.format))}i.setState(function(e,t){return{date:[].concat(n)}})}},i.renderDatePicker=function(){return"in"===i.state.operator?h.createElement(O.RangePicker,{ref:i.dateRef,format:i.props.format,className:"filter-value",placeholder:["From","To"],onChange:i.handleChange}):h.createElement(O,{ref:i.dateRef,format:i.props.format,className:"filter-value",placeholder:i.props.name,onChange:i.handleChange})},i.state={operator:"==",date:null},i.dateRef=h.createRef(),i}return A(e,t),e.prototype.render=function(){var e=this.props.name;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,e),h.createElement("div",{className:"filter-content"},h.createElement(q,{className:"operator-value",defaultValue:"==",onChange:this.handleChange},h.createElement(ee,{value:">"}," > "),h.createElement(ee,{value:"<"}," < "),h.createElement(ee,{value:"=="}," = "),h.createElement(ee,{value:"in"}," in ")),this.renderDatePicker()))},e}(h.Component);ne.propTypes={onChange:y.func.isRequired,name:y.string.isRequired,format:y.string},ne.defaultProps={format:"YYYY-MM-DD"};var ie=function(t){function e(e){var n;return(n=t.call(this,e)||this).componentDidUpdate=function(e,t){n.props.onChange(n.state)},n.handleChange=function(e){var r=e.target.value;n.setState(function(e,t){return{value:r}})},n.state={value:null},n}return A(e,t),e.prototype.render=function(){var e=this.props.name;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,e),h.createElement("div",{className:"filter-content"},h.createElement(k,{style:{width:"100%",minWidth:200},key:e,onChange:this.handleChange,placeholder:e})))},e}(h.Component);ie.propTypes={onChange:y.func.isRequired,name:y.string.isRequired};var ae=function(t){function e(e){var n;return(n=t.call(this,e)||this).componentDidUpdate=function(e,t){n.props.onChange(n.state)},n.handleChange=function(r){n.setState(function(e,t){return{value:r}})},n.state={value:null},n}return A(e,t),e.prototype.render=function(){var e=this.props,t=e.name,r=e.dataSource;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,t),h.createElement("div",{className:"filter-content"},h.createElement(I,{ref:this.inputRef,style:{width:"100%",minWidth:200},allowClear:!0,key:t,onChange:this.handleChange,dataSource:r,placeholder:t})))},e}(h.Component);ae.propTypes={onChange:y.func.isRequired,name:y.string.isRequired,dataSource:y.array};var le=function(t){function e(e){var n;return(n=t.call(this,e)||this).componentDidUpdate=function(e,t){n.props.onChange(n.state)},n.handleChange=function(r){n.setState(function(e,t){return{values:r}})},n.state={values:[]},n}return A(e,t),e.prototype.render=function(){var e=this.props,t=e.name,r=e.dataSource;return h.createElement("div",{className:"ant-filter-container"},h.createElement("span",null,t),h.createElement("div",{className:"filter-content"},h.createElement(q,{style:{minWidth:200,width:"100%"},allowClear:!0,onChange:this.handleChange,mode:"multiple",key:t,placeholder:t},r)))},e}(h.Component);le.propTypes={onChange:y.func.isRequired,name:y.string.isRequired,dataSource:y.array};var se=q.Option,oe=function(t,e,r,n){var i,a;if(r&&1<r.length){var l=[Math.min(r),Math.max(r)],s=l[0],o=l[1];i=isNaN(s)?-1/0:s,a=isNaN(o)?1/0:o}return h.createElement(Z,{key:"number-filter-"+t,name:V(e),onChange:function(e){return n(e,t)},min:i,max:a})},ue=function(t,e,r,n){return h.createElement(ne,{key:"date-filter-"+t,format:T(e),name:V(e),onChange:function(e){return n(e,t)}})},ce=function(t,e,r,n){return h.createElement($,{key:"boolean-filter-"+t,name:V(e),onChange:function(e){return n(e,t)}})},de=function(t,e,r,n){var i=0<r.length?r.map(function(e,t){return h.createElement(se,{key:t}," ",e," ")}):h.createElement(se,{key:t+"-empty"}," - ");return h.createElement(le,{key:"multiselect-filter-"+t,name:V(e),dataSource:i,onChange:function(e){return n(e,t,r)}})},fe=function(t,e,r,n){return h.createElement(ie,{key:"stringInput-filter-"+t,name:V(e),onChange:function(e){return n(e,t)}})},pe=function(t,e,r,n){return h.createElement(ae,{key:"autocomplete-filter-"+t,name:V(e),onChange:function(e){return n(e,t)},dataSource:r})},me=function(t){function e(e){var o;return(o=t.call(this,e)||this).componentDidMount=function(){o.props.autoBuildFilters&&o.autoBuildFilterContent()},o.resetDataSource=function(){o.setState(function(e,t){return{dataSource:t.dataSource}})},o.sendFilterQuery=function(e){var t=o.state.clientFilterBy;if(t)if(0!==t.size){var r,n,i,a=function(l,e){var t=e.clientFilterBy,s="( ",r=function(){if(u){if(c>=o.length)return"break";d=o[c++]}else{if((c=o.next()).done)return"break";d=c.value}var e=d,t=e[0],r=e[1];2<s.length&&(s+=" and (");var n=l.dataFields[t];if("multiselect"===j(n)){var i="";r.forEach(function(e){0<i.length&&(i+=" or "),i+="d."+t+' == "'+e+'"'}),s+=i+=" )"}else{if("autocomplete"===j(n))s+="d."+t+' == "'+r+'"';else if("simplestring"===j(n))s+="isLike(d."+t+", "+r+")";else if("number"===j(n))s+="d."+t+" "+r;else if("bool"===j(n))s+="d."+t+" == "+r;else if("date"===j(n)){var a=T(n);s+=r.includes(",")?H(t,r,a):Q(t,r,a)}s+=" )"}},o=t.entries(),u=Array.isArray(o),c=0;for(o=u?o:o[Symbol.iterator]();;){var d;if("break"===r())break}return s}(o.props,o.state),l=(r=o.props.dataSource,n=a,i=z.parse(n).toJSFunction("d"),r.filter(function(e){return i(e)}));o.setState(function(e,t){return{dataSource:l,isFilterEnabled:!0}})}else o.resetDataSource()},o.discardExcludedFields=function(e){var t=[].concat(e),r=o.props.excludeFields;return r&&0<r.length&&(t=t.filter(function(e){return!r.includes(e)})),t},o.decideFiltersToBuild=function(){var e=o.props.dataSource,t=o.state.visibleFilters;if(0<t.size)return Array.from(t.keys());var r=Object.keys(e[0]);return o.discardExcludedFields(r)},o.autoBuildFilterContent=function(){var e=o.props,n=e.dataFields,i=e.dataSource,t=o.decideFiltersToBuild(),a=new Map;t.forEach(function(e){var t=n[e],r=L(t)||W(i,e);"autocomplete"===t.type&&a.set(e,pe(e,t,r,o.setStringInputFilter)),"simplestring"===t.type&&a.set(e,fe(e,t,0,o.setStringInputFilter)),"multiselect"===t.type&&a.set(e,de(e,t,r,o.setMultiSelectFilter)),"number"===t.type&&a.set(e,oe(e,t,r,o.setNumberFilter)),"bool"===t.type&&a.set(e,ce(e,t,0,o.setBooleanFilter)),"date"===t.type&&a.set(e,ue(e,t,0,o.setDateFilter))}),o.setState(function(e,t){return{filtersContent:a}})},o.manualBuildFilterContent=function(e){var t,r=o.props,n=r.dataFields,i=r.dataSource,a=n[e],l=L(a)||W(i,e);"autocomplete"===a.type&&(t=pe(e,a,l,o.setStringInputFilter)),"simplestring"===a.type&&(t=fe(e,a,0,o.setStringInputFilter)),"multiselect"===a.type&&(t=de(e,a,l,o.setMultiSelectFilter)),"number"===a.type&&(t=oe(e,a,l,o.setNumberFilter)),"bool"===a.type&&(t=ce(e,a,0,o.setBooleanFilter)),"date"===a.type&&(t=ue(e,a,0,o.setDateFilter));var s=o.state.filtersContent;s.has(e)?s.delete(e):s.set(e,t),o.setState(function(e,t){return{filtersContent:s}})},o.setDateFilter=function(e,t){var r=e.operator,n=e.date,i=o.state.clientFilterBy,a=U(o.props.dataFields,t),l=r+" "+n;n?i.set(a,l):i.delete(a),o.setState({clientFilterBy:i})},o.setNumberFilter=function(e,t){var r=e.operator,n=e.number,i=o.state.clientFilterBy,a=U(o.props.dataFields,t),l=r+" "+n;n?i.set(a,l):i.delete(a),o.setState({clientFilterBy:i})},o.setStringInputFilter=function(e,t){var r=e.value,n=o.state.clientFilterBy,i=U(o.props.dataFields,t);r?n.set(i,r):n.delete(i),o.setState({clientFilterBy:n})},o.setMultiSelectFilter=function(e,t,r){var n=e.values,i=o.state.clientFilterBy,a=U(o.props.dataFields,t),l=n.map(function(e){return r[e]});l&&0!==l.length?i.set(a,l):i.delete(a),o.setState({clientFilterBy:i})},o.setBooleanFilter=function(e,t){var r=e.value,n=o.state.clientFilterBy,i=U(o.props.dataFields,t);r&&" - "!==r?n.set(i,r):n.delete(i),o.setState({clientFilterBy:n})},o.closeFiltersDrawer=function(){o.setState(function(e,t){return{filtersDrawerVisible:!1}})},o.toggleFilterSelection=function(e){var t=e.target,r=t.name,n=t.checked,i=o.state,a=i.visibleFilters,l=i.clientFilterBy;a.set(r,n);var s=l;s.has(r)&&s.delete(r),o.setState(function(e,t){return{visibleFilters:a,clientFilterBy:s}}),o.manualBuildFilterContent(r)},o.filterSelectionContent=function(){var e=Object.keys(o.props.dataSource[0]),t=o.discardExcludedFields(e).map(function(e){return h.createElement(m,{name:e,key:e+"-filter-selection",checked:o.state.visibleFilters.get(e),onChange:o.toggleFilterSelection},V(o.props.dataFields[e]))});return h.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},t)},o.clearFilters=function(e){o.setState(function(e,t){return{isFilterEnabled:!1,dataSource:t.dataSource,clientFilterBy:new Map,filtersContent:new Map}},o.autoBuildFilterContent)},o.showFiltersInDrawer=function(){var e=[],t=o.state.filtersContent.values(),r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var a=i;e.push(a)}return 0<e.length&&e.push(o.buildSenderButton()),0===e.length&&e.push(h.createElement("p",{key:"no-items"}," No Items ")),e},o.toggleDrawerVisibility=function(e){o.setState(function(e,t){return{filtersDrawerVisible:!e.filtersDrawerVisible}})},o.onSearchAllClient=function(t){var r=[];r=0===t.length?o.props.dataSource:o.props.dataSource.filter(function(e){return Object.values(e).map(function(e){return""+e}).some(function(e){return e.toLowerCase().includes(t.toLowerCase())})}),o.setState(function(e,t){return{dataSource:r,clientFilterBy:new Map,visibleFilters:t.savedVisibleFilters||new Map,filtersContent:new Map,filtersDrawerVisible:!1,isFilterEnabled:!0}})},o.buildSenderButton=function(){return h.createElement(f,{key:"query-sender-button",tabIndex:"1",type:"primary",style:{marginTop:"1em"},onClick:o.sendFilterQuery},"Search")},o.state={isFilterEnabled:!1,dataSource:o.props.dataSource,clientFilterBy:new Map,visibleFilters:new Map,filtersContent:new Map,filtersDrawerVisible:!1},o.inputSearchRef=h.createRef(),o}return A(e,t),e.prototype.render=function(){var e=this.props,t=e.autoBuildFilters,r=e.renderList,n=e.withFilterPicker;return h.createElement("div",{className:"list-filter-container"},h.createElement(i,{className:"list-filters"},h.createElement(c,{closable:!0,mask:!1,onClose:this.closeFiltersDrawer,visible:this.state.filtersDrawerVisible},h.createElement("div",{className:"filters-content"},this.showFiltersInDrawer())),h.createElement("div",{className:"filter-controls"},h.createElement("div",{className:"filter-controls-left"},n&&h.createElement("div",{className:"filter-picker"},h.createElement(l,{placement:"left",title:(this.state.filtersDrawerVisible?"Hide":"Show")+" Filters"},h.createElement(f,{style:{margin:"0.3em"},type:"primary",shape:"circle",onClick:this.toggleDrawerVisibility},h.createElement(o,{type:"filter"}))),!t&&h.createElement(a,{placement:"bottom",trigger:"hover",content:this.filterSelectionContent()},h.createElement(l,{placement:"right",title:"Available Filters"},h.createElement(f,{type:"circle"},h.createElement(o,{type:"bars"}))))),this.state.isFilterEnabled&&h.createElement(f,{onClick:this.clearFilters,style:{margin:"0.3em"},type:"danger",icon:"close"},"Clear")),h.createElement("div",{className:"filter-controls-right"},h.createElement(K,{clearText:!this.state.isFilterEnabled,onSearch:this.onSearchAllClient})))),r(this.state.dataSource))},e}(h.Component);me.propTypes={dataFields:y.objectOf(y.shape({type:y.oneOf(["simplestring","autocomplete","multiselect","number","date","bool"]).isRequired,uiName:y.string.isRequired,format:y.string,dataSource:y.array,nullValue:y.any})).isRequired,savedVisibleFilters:y.array,dataSource:y.arrayOf(Object).isRequired,autoBuildFilters:y.bool,renderList:y.func.isRequired,excludeFields:y.arrayOf(y.string),withFilterPicker:y.bool},me.defaultProps={withFilterPicker:!0,autoBuildFilters:!1};var he=function(t){function e(e){var c;return(c=t.call(this,e)||this).componentDidMount=function(){c.props.autoBuildFilters&&c.autoBuildFilterContent()},c.resetDataSource=function(){c.setState(function(e,t){return{dataSource:t.dataSource}})},c.mapFiltersToServer=function(){var e=[],t=c.state.clientFilterBy,r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var a=i,l=a[0],s=a[1],o=c.props.dataFields[l],u={Name:l,Type:j(o),Values:Array.isArray(s)?s:[s]};e.push(u)}return e},c.discardExcludedFields=function(e){var t=[].concat(e),r=c.props.excludeFields;return r&&0<r.length&&(t=t.filter(function(e){return!r.includes(e)})),t},c.decideFiltersToBuild=function(){var e=c.props.dataSource,t=c.state.visibleFilters;if(0<t.size)return Array.from(t.keys());var r=Object.keys(e[0]);return c.discardExcludedFields(r)},c.autoBuildFilterContent=function(){var n=c.props.dataFields,e=c.decideFiltersToBuild(),i=new Map;e.forEach(function(e){var t=n[e],r=L(n[e]);"autocomplete"===t.type&&i.set(e,pe(e,t,r,c.setStringInputFilter)),"simplestring"===t.type&&i.set(e,fe(e,t,0,c.setStringInputFilter)),"multiselect"===t.type&&i.set(e,de(e,t,r,c.setMultiSelectFilter)),"number"===t.type&&i.set(e,oe(e,t,r,c.setNumberFilter)),"bool"===t.type&&i.set(e,ce(e,t,0,c.setBooleanFilter)),"date"===t.type&&i.set(e,ue(e,t,0,c.setDateFilter))}),c.setState(function(e,t){return{filtersContent:i}})},c.manualBuildFilterContent=function(e){var t,r=c.props.dataFields[e];if("autocomplete"===r.type){var n=L(r,!0);t=pe(e,r,n,c.setStringInputFilter)}if("simplestring"===r.type){L(r,!1);t=fe(e,r,0,c.setStringInputFilter)}if("multiselect"===r.type){var i=L(r,!0);t=de(e,r,i,c.setMultiSelectFilter)}if("number"===r.type){var a=L(r,!1);t=oe(e,r,a,c.setNumberFilter)}if("bool"===r.type){L(r,!1);t=ce(e,r,0,c.setBooleanFilter)}if("date"===r.type){L(r,!1);t=ue(e,r,0,c.setDateFilter)}var l=c.state.filtersContent;l.has(e)?l.delete(e):l.set(e,t),c.setState(function(e,t){return{filtersContent:l}})},c.setDateFilter=function(e,t){var r=e.operator,n=e.date,i=c.state.clientFilterBy,a=U(c.props.dataFields,t),l=r+" "+n;n?i.set(a,l):i.delete(a),c.setState({clientFilterBy:i})},c.setNumberFilter=function(e,t){var r=e.operator,n=e.number,i=c.state.clientFilterBy,a=U(c.props.dataFields,t),l=r+" "+n;n?i.set(a,l):i.delete(a),c.setState({clientFilterBy:i})},c.setStringInputFilter=function(e,t){var r=e.value,n=c.state.clientFilterBy,i=U(c.props.dataFields,t);r?n.set(i,r):n.delete(i),c.setState({clientFilterBy:n})},c.setMultiSelectFilter=function(e,t,r){var n=e.values,i=c.state.clientFilterBy,a=U(c.props.dataFields,t),l=n.map(function(e){return r[e]});l&&0!==l.length?i.set(a,l):i.delete(a),c.setState({clientFilterBy:i})},c.setBooleanFilter=function(e,t){var r=e.value,n=c.state.clientFilterBy,i=U(c.props.dataFields,t);r&&" - "!==r?n.set(i,r):n.delete(i),c.setState({clientFilterBy:n})},c.closeFiltersDrawer=function(){c.setState(function(e,t){return{filtersDrawerVisible:!1}})},c.toggleFilterSelection=function(e){var t=e.target,r=t.name,n=t.checked,i=c.state,a=i.visibleFilters,l=i.clientFilterBy;a.set(r,n);var s=l;s.has(r)&&s.delete(r),c.setState(function(e,t){return{visibleFilters:a,clientFilterBy:s}}),c.manualBuildFilterContent(r)},c.filterSelectionContent=function(){var e=Object.keys(c.props.dataSource[0]),t=c.discardExcludedFields(e).map(function(e){return h.createElement(m,{name:e,key:e+"-filter-selection",checked:c.state.visibleFilters.get(e),onChange:c.toggleFilterSelection},V(c.props.dataFields[e]))});return h.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},t)},c.clearFilters=function(e){c.setState(function(e,t){return{isFilterEnabled:!1,dataSource:t.dataSource,ServerFilterBy:[],FilteredData:[],clientFilterBy:new Map,filtersContent:new Map}},c.autoBuildFilterContent)},c.showFiltersInDrawer=function(){var e=[],t=c.state.filtersContent.values(),r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var a=i;e.push(a)}return 0<e.length&&e.push(c.buildSenderButton()),0===e.length&&e.push(h.createElement("p",{key:"no-items"}," No Items ")),e},c.toggleDrawerVisibility=function(e){c.setState(function(e,t){return{filtersDrawerVisible:!e.filtersDrawerVisible}})},c.onSearchAllServer=function(){var t=_(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[{Name:"ALL",Type:null,Values:[t.toLowerCase()]}],c.setState(function(e,t){return{ServerFilterBy:r,visibleFilters:t.savedVisibleFilters||new Map,filtersContent:new Map,filtersDrawerVisible:!1,isFilterEnabled:!0,isSearching:!0}}),e.next=4,c.props.onPostFilters(r);case 4:n=e.sent,c.setState(function(e,t){return{FilteredData:n,isSearching:!1}});case 6:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),c.buildSenderButton=function(){return h.createElement(f,{tabIndex:"1",key:"query-sender-button",loading:c.state.isSearching,type:"primary",style:{marginTop:"1em"},onClick:c.handleServerFiltering},"Search")},c.handleServerFiltering=function(){var t=_(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.mapFiltersToServer(),c.setState(function(e,t){return{ServerFilterBy:r,isFilterEnabled:!0,isSearching:!0}}),e.next=4,c.props.onPostFilters(r);case 4:n=e.sent,c.setState({FilteredData:n,isSearching:!1});case 6:case"end":return e.stop()}},e,this)}));return function(e){return t.apply(this,arguments)}}(),c.renderListComponent=function(e){var t=c.state,r=t.ServerFilterBy,n=t.isSearching,i=t.dataSource,a=t.FilteredData;return 0<r.length?n?e(i,!0):e(a,!1):e(i,!1)},c.state={isSearching:!1,isFilterEnabled:!1,dataSource:c.props.dataSource,clientFilterBy:new Map,ServerFilterBy:[],FilteredData:[],visibleFilters:new Map,filtersContent:new Map,filtersDrawerVisible:!1},c.inputSearchRef=h.createRef(),c}return A(e,t),e.prototype.render=function(){var e=this.props,t=e.autoBuildFilters,r=e.renderList,n=e.withFilterPicker;return h.createElement("div",{className:"list-filter-container"},h.createElement(i,{className:"list-filters"},h.createElement(c,{closable:!0,mask:!1,onClose:this.closeFiltersDrawer,visible:this.state.filtersDrawerVisible},h.createElement("div",{className:"filters-content"},this.showFiltersInDrawer())),h.createElement("div",{className:"filter-controls"},h.createElement("div",{className:"filter-controls-left"},n&&h.createElement("div",{className:"filter-picker"},h.createElement(l,{placement:"left",title:(this.state.filtersDrawerVisible?"Hide":"Show")+" Filters"},h.createElement(f,{style:{margin:"0.3em"},type:"primary",shape:"circle",onClick:this.toggleDrawerVisibility},h.createElement(o,{type:"filter"}))),!t&&h.createElement(a,{placement:"bottom",trigger:"hover",content:this.filterSelectionContent()},h.createElement(l,{placement:"right",title:"Available Filters"},h.createElement(f,{type:"circle"},h.createElement(o,{type:"bars"}))))),this.state.isFilterEnabled&&h.createElement(f,{onClick:this.clearFilters,style:{margin:"0.3em"},type:"danger",icon:"close"},"Clear")),h.createElement("div",{className:"filter-controls-right"},h.createElement(K,{clearText:this.state.isFilterEnabled&&this.state.ServerFilterBy[0]&&"ALL"!==this.state.ServerFilterBy[0].Name,onSearch:this.onSearchAllServer})))),this.renderListComponent(r))},e}(h.Component);he.propTypes={dataFields:y.objectOf(y.shape({type:y.oneOf(["simplestring","autocomplete","multiselect","number","date","bool"]).isRequired,uiName:y.string.isRequired,format:y.string,dataSource:y.array.isRequired,nullValue:y.any}).isRequired).isRequired,savedVisibleFilters:y.array,dataSource:y.arrayOf(y.object).isRequired,autoBuildFilters:y.bool,onPostFilters:y.func.isRequired,renderList:y.func.isRequired,customStyles:y.objectOf(y.object),excludeFields:y.arrayOf(y.string),withFilterPicker:y.bool},he.defaultProps={withFilterPicker:!0,autoBuildFilters:!1};var ye=me,ve=he,Fe={ClientFilter:ye,ServerFilter:ve};e.ClientFilter=ye,e.ServerFilter=ve,e.default=Fe,Object.defineProperty(e,"__esModule",{value:!0})});
